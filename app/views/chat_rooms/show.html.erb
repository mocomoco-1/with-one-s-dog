<div class="w-full sm:w-full md:max-w-md lg:max-w-lg xl:max-w-2xl mx-auto mt-2">
  <div class="flex flex-col mb-2 w-full">
    <!-- チャットルーム名 -->
    <h1 class="text-lg font-semibold text-center mb-1">
      <%= @chat_room.display_name(current_user) %>
    </h1>

    <!-- メッセージ一覧 -->
    <div class="card-body border rounded-lg h-96 overflow-y-scroll bg-base-100 space-y-3 p-3">
      <% @chat_messages.each do |message| %>
      <div class="flex <%= message.user == current_user ? 'justify-end' : 'justify-start' %> items-start space-x-2">
        <!-- 左側アバター（相手用） -->
        <% unless message.user == current_user %>
        <div class="chat-image avatar">
          <div class="flex-shrink-0 mr-3" style="width: 40px; height: 40px;">
            <%= image_tag "dog.png", class: "rounded-full w-full h-full object-cover" %>
          </div>
        </div>
        <% end %>
        <!-- 吹き出し + 名前 -->
        <div class="flex flex-col">
          <div class="text-xs text-gray-500 mb-1">
            <%= message.user.name %> ・
            <time class="text-xs opacity-50 ml-1"><%= l message.created_at, format: :short %></time>
          </div>
          <div class="px-3 py-2 rounded-lg break-words <%= message.user == current_user ? 'bg-base-200' : 'bg-accent' %> max-w-xs break-words">
            <%= message.content %>
          </div>
        </div>
        <!-- 右側アバター（自分用） -->
        <% if message.user == current_user %>
        <div class="chat-image avatar">
          <div class="flex-shrink-0 ml-3" style="width: 40px; height: 40px;">
            <%= image_tag "dog.png", class: "rounded-full w-full h-full object-cover" %>
          </div>
        </div>
        <% end %>
      </div>
      <% end %>
    </div>
    <!-- メッセージ送信フォーム -->
    <%= form_with model: [@chat_room, @chat_message], local: true, class: "flex gap-2 mt-3" do |f| %>
    <%= f.text_area :content, placeholder: "メッセージを入力", class: "textarea textarea-neutral flex-1 resize-none h-12" %>
    <%= f.submit "送信", class: "btn btn-secondary" %>
    <% end %>
  </div>
</div>